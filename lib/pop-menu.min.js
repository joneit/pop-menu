"use strict";function build(n,e,a){a=a||{};var t,i=a.prompt,r=a.blacklist,o=a.sort,l=a.breadcrumbs||[],u=l?l.join(".")+".":"";if(n instanceof Element?(t=n.tagName,a.append||(n.innerHTML="")):(t=n,n=document.createElement(t)),e){var f,m;"SELECT"===t?(f=n.add,i?(m=new Option(i,""),m.innerHTML+="&hellip;",n.add(m)):null!==i&&n.add(new Option)):(f=n.appendChild,n.label=i),o&&(e=e.slice().sort(itemComparator)),e.forEach(function(e,t){if(a&&"string"==typeof e){var i=e.match(REGEXP_INDIRECTION);if(i){var m=i[1],c=i[2],p=a[m];if("function"!=typeof p)throw"build: Expected options."+m+" to be a function.";e=p(c)}}var s=e.submenu||e;if(s instanceof Array){var d={breadcrumbs:l.concat(t+1),prompt:e.label||"Group "+u+(t+1),options:o,blacklist:r},b=build("OPTGROUP",s,d);b.childElementCount&&n.add(b)}else if("object"!=typeof e)r&&r.indexOf(e)>=0||f.call(n,new Option(e));else if(!e.hidden){var E=e.name||e.alias;r&&r.indexOf(E)>=0||f.call(n,new Option(e.alias||e.name,E))}})}else n.type="text";return n}function itemComparator(n,e){return n=n.alias||n.name||n.label||n,e=e.alias||e.name||e.label||e,e>n?-1:n>e?1:0}function findItem(n,e){var a,t,i;return a=n.find(function(n){var a=n.submenu||n;return a instanceof Array?t=findItem(a,e):(n.name||n)===e}),i=t||a,i&&(i.name?i:{name:i})}function walk(n,e){var a=0;return n.forEach(function(n){var t=n.submenu||n;t instanceof Array?a+=walk(t,e):(e(n.name?n:{name:n},a),a+=1)}),a}function formatItem(n){var e=n.name||n;return n.alias&&(e='"'+n.alias+'" ('+e+")"),e}function isGroupProxy(n){return REGEXP_INDIRECTION.test(n)}var REGEXP_INDIRECTION=/^(\w+)\((\w+)\)$/,popMenu={build:build,walk:walk,findItem:findItem,formatItem:formatItem,isGroupProxy:isGroupProxy};window.popMenu=popMenu;