"use strict";function build(n,e,a){a=a||{};var t,i=a.prompt,r=a.blacklist,o=a.sort,l=a.breadcrumbs||[],u=l?l.join(".")+".":"";if(n instanceof Element?(t=n.tagName,a.append||(n.innerHTML="")):(t=n,n=document.createElement(t)),e){var m,f;"SELECT"===t?(m=n.add,i?(f=new Option(i,""),f.innerHTML+="&hellip;",n.add(f)):null!==i&&n.add(new Option)):(m=n.appendChild,n.label=i),o&&(e=e.slice().sort(itemComparator)),e.forEach(function(e,t){if(a&&"string"==typeof e){var i=e.match(REGEXP_INDIRECTION);if(i){var f=i[1],s=i[2],c=a[f];if("function"!=typeof c)throw"build: Expected options."+f+" to be a function.";e=c(s)}}var d=e.submenu||e;if(d instanceof Array){var p={breadcrumbs:l.concat(t+1),prompt:e.label||"Group "+u+(t+1),options:o,blacklist:r},b=build("OPTGROUP",d,p);b.childElementCount&&n.add(b)}else if("object"!=typeof e)r&&r.indexOf(e)>=0||m.call(n,new Option(e));else if(!e.hidden){var E=e.name||e.alias;r&&r.indexOf(E)>=0||m.call(n,new Option(e.alias||e.name,E))}})}else n.type="text";return n}function itemComparator(n,e){return n=n.alias||n.name||n.label||n,e=e.alias||e.name||e.label||e,e>n?-1:n>e?1:0}function findItem(n,e){var a,t,i;return a=n.find(function(n){var a=n.submenu||n;return a instanceof Array?t=findItem(a,e):(n.name||n)===e}),i=t||a,i&&(i.name?i:{name:i})}function walk(n,e){var a,t,i,r,o=0;for(a=n.length-1;a>0;--a)t=n[a],i=t.submenu||t,i instanceof Array||(i=void 0),i||(r=e(t.name?t:{name:t},o),o+=1,void 0!==r&&(null===r?(n.splice(a,1),o-=1):(n[a]=t=r,i=t.submenu||t,i instanceof Array||(i=void 0)))),i&&(o+=walk(i,e),0===i.length&&(n.splice(a,1),o-=1));return o}function formatItem(n){var e=n.name||n;return n.alias&&(e='"'+n.alias+'" ('+e+")"),e}function isGroupProxy(n){return REGEXP_INDIRECTION.test(n)}var REGEXP_INDIRECTION=/^(\w+)\((\w+)\)$/,popMenu={build:build,walk:walk,findItem:findItem,formatItem:formatItem,isGroupProxy:isGroupProxy};window.popMenu=popMenu;